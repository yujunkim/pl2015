<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>Norm</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Norm</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab918"></a><h1 class="section">Norm: Normalization of STLC</h1>

</div>
<div class="code">

<br/>

<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <a class="idref" href="Smallstep.html#"><span class="id" type="library">Smallstep</span></a>.<br/>
<span class="id" type="keyword">Hint Constructors</span> <a class="idref" href="Norm.html#multi"><span class="id" type="inductive">multi</span></a>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

(This chapter is optional.)

<div class="paragraph"> </div>

In this chapter, we consider another fundamental theoretical property
of the simply typed lambda-calculus: the fact that the evaluation of a
well-typed program is guaranteed to halt in a finite number of
steps---i.e., every well-typed term is <i>normalizable</i>.

<div class="paragraph"> </div>

Unlike the type-safety properties we have considered so far, the
normalization property does not extend to full-blown programming
languages, because these languages nearly always extend the simply
typed lambda-calculus with constructs, such as general recursion
(as we discussed in the MoreStlc chapter) or recursive types, that can
be used to write nonterminating programs.  However, the issue of
normalization reappears at the level of <i>types</i> when we consider the
metatheory of polymorphic versions of the lambda calculus such as
F_omega: in this system, the language of types effectively contains a
copy of the simply typed lambda-calculus, and the termination of the
typechecking algorithm will hinge on the fact that a ``normalization''
operation on type expressions is guaranteed to terminate.

<div class="paragraph"> </div>

Another reason for studying normalization proofs is that they are some
of the most beautiful---and mind-blowing---mathematics to be found in
the type theory literature, often (as here) involving the fundamental
proof technique of <i>logical relations</i>.

<div class="paragraph"> </div>

The calculus we shall consider here is the simply typed
lambda-calculus over a single base type <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" type="inductive">bool</span></a></span> and with pairs. We'll
give full details of the development for the basic lambda-calculus
terms treating <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" type="inductive">bool</span></a></span> as an uninterpreted base type, and leave the
extension to the boolean operators and pairs to the reader.  Even for
the base calculus, normalization is not entirely trivial to prove,
since each reduction of a term can duplicate redexes in subterms. 
<div class="paragraph"> </div>

<a name="lab919"></a><h4 class="section">Exercise: 1 star</h4>
 Where do we fail if we attempt to prove normalization by a
straightforward induction on the size of a well-typed term? 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab920"></a><h1 class="section">Language</h1>

<div class="paragraph"> </div>

 We begin by repeating the relevant language definition, which is
similar to those in the MoreStlc chapter, and supporting results
including type preservation and step determinism.  (We won't need
progress.)  You may just wish to skip down to the Normalization
section... 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab921"></a><h3 class="section">Syntax and Operational Semantics</h3>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="ty"><span class="id" type="inductive">ty</span></a> : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="TBool"><span class="id" type="constructor">TBool</span></a> : <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a><br/>
&nbsp;&nbsp;| <a name="TArrow"><span class="id" type="constructor">TArrow</span></a> : <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a> → <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a> → <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a><br/>
&nbsp;&nbsp;| <a name="TProd"><span class="id" type="constructor">TProd</span></a>  : <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a> → <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a> → <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a><br/>
.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "T_cases" <span class="id" type="var">tactic</span>(<span class="id" type="tactic">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "TBool" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "TArrow" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "TProd" ].<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="tm"><span class="id" type="inductive">tm</span></a> : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="tvar"><span class="id" type="constructor">tvar</span></a> : <a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="tapp"><span class="id" type="constructor">tapp</span></a> : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="tabs"><span class="id" type="constructor">tabs</span></a> : <a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> → <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="tpair"><span class="id" type="constructor">tpair</span></a> : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="tfst"><span class="id" type="constructor">tfst</span></a> : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="tsnd"><span class="id" type="constructor">tsnd</span></a> : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="ttrue"><span class="id" type="constructor">ttrue</span></a> : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="tfalse"><span class="id" type="constructor">tfalse</span></a> : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a><br/>
&nbsp;&nbsp;| <a name="tif"><span class="id" type="constructor">tif</span></a> : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "t_cases" <span class="id" type="var">tactic</span>(<span class="id" type="tactic">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tvar" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tapp" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tabs"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tpair" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tfst" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tsnd"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ttrue" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tfalse" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "tif" ].<br/>

<br/>
</div>

<div class="doc">
<a name="lab922"></a><h3 class="section">Substitution</h3>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="subst"><span class="id" type="definition">subst</span></a> (<span class="id" type="var">x</span>:<a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a>) (<span class="id" type="var">s</span>:<a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a>) (<span class="id" type="var">t</span>:<a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a>) : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Norm.html#tvar"><span class="id" type="constructor">tvar</span></a> <span class="id" type="var">y</span> ⇒ <span class="id" type="keyword">if</span> <a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="var">y</span> <span class="id" type="keyword">then</span> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="keyword">else</span> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a> <span class="id" type="var">y</span> <span class="id" type="var">T</span> <span class="id" type="var">t1</span> ⇒  <a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a> <span class="id" type="var">y</span> <span class="id" type="var">T</span> (<span class="id" type="keyword">if</span> <a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="var">y</span> <span class="id" type="keyword">then</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">else</span> (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t1</span>))<br/>
&nbsp;&nbsp;| <a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> ⇒ <a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t1</span>) (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> ⇒ <a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t1</span>) (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Norm.html#tfst"><span class="id" type="constructor">tfst</span></a> <span class="id" type="var">t1</span> ⇒ <a class="idref" href="Norm.html#tfst"><span class="id" type="constructor">tfst</span></a> (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t1</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Norm.html#tsnd"><span class="id" type="constructor">tsnd</span></a> <span class="id" type="var">t1</span> ⇒ <a class="idref" href="Norm.html#tsnd"><span class="id" type="constructor">tsnd</span></a> (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t1</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Norm.html#ttrue"><span class="id" type="constructor">ttrue</span></a> ⇒ <a class="idref" href="Norm.html#ttrue"><span class="id" type="constructor">ttrue</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Norm.html#tfalse"><span class="id" type="constructor">tfalse</span></a> ⇒ <a class="idref" href="Norm.html#tfalse"><span class="id" type="constructor">tfalse</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> <span class="id" type="var">t0</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> ⇒ <a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t0</span>) (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t1</span>) (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">t2</span>) <br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="::'['_x_':='_x_']'_x"><span class="id" type="notation">"</span></a>'[' x ':=' s ']' t" := (<a class="idref" href="Norm.html#subst"><span class="id" type="definition">subst</span></a> <span class="id" type="var">x</span> <span class="id" type="var">s</span> <span class="id" type="var">t</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 20).<br/>

<br/>
</div>

<div class="doc">
<a name="lab923"></a><h3 class="section">Reduction</h3>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="value"><span class="id" type="inductive">value</span></a> : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="v_abs"><span class="id" type="constructor">v_abs</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">T11</span> <span class="id" type="var">t12</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> (<a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#T11"><span class="id" type="variable">T11</span></a> <a class="idref" href="Norm.html#t12"><span class="id" type="variable">t12</span></a>)<br/>
&nbsp;&nbsp;| <a name="v_pair"><span class="id" type="constructor">v_pair</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> (<a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a>)<br/>
&nbsp;&nbsp;| <a name="v_true"><span class="id" type="constructor">v_true</span></a> : <a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#ttrue"><span class="id" type="constructor">ttrue</span></a><br/>
&nbsp;&nbsp;| <a name="v_false"><span class="id" type="constructor">v_false</span></a> : <a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#tfalse"><span class="id" type="constructor">tfalse</span></a><br/>
.<br/>

<br/>
<span class="id" type="keyword">Hint Constructors</span> <a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a>.<br/>

<br/>
<span class="id" type="keyword">Reserved Notation</span> "t1 '==&gt;' t2" (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="step"><span class="id" type="inductive">step</span></a> : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="ST_AppAbs"><span class="id" type="constructor">ST_AppAbs</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">T11</span> <span class="id" type="var">t12</span> <span class="id" type="var">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> (<a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#T11"><span class="id" type="variable">T11</span></a> <a class="idref" href="Norm.html#t12"><span class="id" type="variable">t12</span></a>) <a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t12"><span class="id" type="variable">t12</span></a><br/>
&nbsp;&nbsp;| <a name="ST_App1"><span class="id" type="constructor">ST_App1</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t1'"><span class="id" type="variable">t1'</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#t1'"><span class="id" type="variable">t1'</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="ST_App2"><span class="id" type="constructor">ST_App2</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t2'"><span class="id" type="variable">t2'</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="Norm.html#t2'"><span class="id" type="variable">t2'</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="ST_Pair1"><span class="id" type="constructor">ST_Pair1</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t1'"><span class="id" type="variable">t1'</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#t1'"><span class="id" type="variable">t1'</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="ST_Pair2"><span class="id" type="constructor">ST_Pair2</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">v1</span> <span class="id" type="var">t2</span> <span class="id" type="var">t2'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t2'"><span class="id" type="variable">t2'</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="Norm.html#t2'"><span class="id" type="variable">t2'</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="ST_Fst"><span class="id" type="constructor">ST_Fst</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t1'"><span class="id" type="variable">t1'</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tfst"><span class="id" type="constructor">tfst</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tfst"><span class="id" type="constructor">tfst</span></a> <a class="idref" href="Norm.html#t1'"><span class="id" type="variable">t1'</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="ST_FstPair"><span class="id" type="constructor">ST_FstPair</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tfst"><span class="id" type="constructor">tfst</span></a> (<a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a>)<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a><br/>
&nbsp;&nbsp;| <a name="ST_Snd"><span class="id" type="constructor">ST_Snd</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t1</span> <span class="id" type="var">t1'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t1'"><span class="id" type="variable">t1'</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tsnd"><span class="id" type="constructor">tsnd</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tsnd"><span class="id" type="constructor">tsnd</span></a> <a class="idref" href="Norm.html#t1'"><span class="id" type="variable">t1'</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="ST_SndPair"><span class="id" type="constructor">ST_SndPair</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tsnd"><span class="id" type="constructor">tsnd</span></a> (<a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> <a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a>)<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#v2"><span class="id" type="variable">v2</span></a><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="ST_IfTrue"><span class="id" type="constructor">ST_IfTrue</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> <a class="idref" href="Norm.html#ttrue"><span class="id" type="constructor">ttrue</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a><br/>
&nbsp;&nbsp;| <a name="ST_IfFalse"><span class="id" type="constructor">ST_IfFalse</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> <a class="idref" href="Norm.html#tfalse"><span class="id" type="constructor">tfalse</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><br/>
&nbsp;&nbsp;| <a name="ST_If"><span class="id" type="constructor">ST_If</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t0</span> <span class="id" type="var">t0'</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#t0"><span class="id" type="variable">t0</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t0'"><span class="id" type="variable">t0'</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> <a class="idref" href="Norm.html#t0"><span class="id" type="variable">t0</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> <a class="idref" href="Norm.html#t0'"><span class="id" type="variable">t0'</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a><a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">)</span></a><br/>
<br/>
<span class="id" type="keyword">where</span> <a name="::x_'==>'_x"><span class="id" type="notation">"</span></a>t1 '==&gt;' t2" := (<a class="idref" href="Norm.html#step"><span class="id" type="inductive">step</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>).<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "step_cases" <span class="id" type="var">tactic</span>(<span class="id" type="tactic">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_AppAbs" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_App1" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_App2"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Pair1" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Pair2"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Fst" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_FstPair"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_Snd" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_SndPair"<br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_IfTrue" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_IfFalse" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "ST_If" ].<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="multistep"><span class="id" type="abbreviation">multistep</span></a> := (<a class="idref" href="Smallstep.html#multi"><span class="id" type="inductive">multi</span></a> <a class="idref" href="Norm.html#step"><span class="id" type="inductive">step</span></a>).<br/>
<span class="id" type="keyword">Notation</span> <a name="::x_'==>*'_x"><span class="id" type="notation">"</span></a>t1 '==&gt;*' t2" := (<a class="idref" href="Norm.html#multistep"><span class="id" type="abbreviation">multistep</span></a> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>) (<span class="id" type="tactic">at</span> <span class="id" type="keyword">level</span> 40).<br/>

<br/>
<span class="id" type="keyword">Hint Constructors</span> <a class="idref" href="Norm.html#step"><span class="id" type="inductive">step</span></a>.<br/>

<br/>
<span class="id" type="keyword">Notation</span> <a name="step_normal_form"><span class="id" type="abbreviation">step_normal_form</span></a> := (<a class="idref" href="Smallstep.html#normal_form"><span class="id" type="definition">normal_form</span></a> <a class="idref" href="Norm.html#step"><span class="id" type="inductive">step</span></a>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="value__normal"><span class="id" type="lemma">value__normal</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t</span>, <a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> → <a class="idref" href="Norm.html#step_normal_form"><span class="id" type="abbreviation">step_normal_form</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span> <span class="id" type="keyword">with</span> <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">intros</span> [<span class="id" type="var">t'</span> <span class="id" type="var">ST</span>]; <span class="id" type="tactic">inversion</span> <span class="id" type="var">ST</span>...<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab924"></a><h3 class="section">Typing</h3>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <span class="id" type="keyword">context</span> := <a class="idref" href="SfLib.html#partial_map"><span class="id" type="definition">partial_map</span></a> <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a>.<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="has_type"><span class="id" type="inductive">has_type</span></a> : <span class="id" type="keyword">context</span> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a> → <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="T_Var"><span class="id" type="constructor">T_Var</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">x</span> <span class="id" type="var">T</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#tvar"><span class="id" type="constructor">tvar</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a>) <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a><br/>
&nbsp;&nbsp;| <a name="T_Abs"><span class="id" type="constructor">T_Abs</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">x</span> <span class="id" type="var">T11</span> <span class="id" type="var">T12</span> <span class="id" type="var">t12</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> (<a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#T11"><span class="id" type="variable">T11</span></a>) <a class="idref" href="Norm.html#t12"><span class="id" type="variable">t12</span></a> <a class="idref" href="Norm.html#T12"><span class="id" type="variable">T12</span></a> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#T11"><span class="id" type="variable">T11</span></a> <a class="idref" href="Norm.html#t12"><span class="id" type="variable">t12</span></a>) (<a class="idref" href="Norm.html#TArrow"><span class="id" type="constructor">TArrow</span></a> <a class="idref" href="Norm.html#T11"><span class="id" type="variable">T11</span></a> <a class="idref" href="Norm.html#T12"><span class="id" type="variable">T12</span></a>)<br/>
&nbsp;&nbsp;| <a name="T_App"><span class="id" type="constructor">T_App</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> (<a class="idref" href="Norm.html#TArrow"><span class="id" type="constructor">TArrow</span></a> <a class="idref" href="Norm.html#T1"><span class="id" type="variable">T1</span></a> <a class="idref" href="Norm.html#T2"><span class="id" type="variable">T2</span></a>) → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a> <a class="idref" href="Norm.html#T1"><span class="id" type="variable">T1</span></a> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>) <a class="idref" href="Norm.html#T2"><span class="id" type="variable">T2</span></a><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="T_Pair"><span class="id" type="constructor">T_Pair</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#T1"><span class="id" type="variable">T1</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a> <a class="idref" href="Norm.html#T2"><span class="id" type="variable">T2</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>) (<a class="idref" href="Norm.html#TProd"><span class="id" type="constructor">TProd</span></a> <a class="idref" href="Norm.html#T1"><span class="id" type="variable">T1</span></a> <a class="idref" href="Norm.html#T2"><span class="id" type="variable">T2</span></a>)<br/>
&nbsp;&nbsp;| <a name="T_Fst"><span class="id" type="constructor">T_Fst</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">t</span> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> (<a class="idref" href="Norm.html#TProd"><span class="id" type="constructor">TProd</span></a> <a class="idref" href="Norm.html#T1"><span class="id" type="variable">T1</span></a> <a class="idref" href="Norm.html#T2"><span class="id" type="variable">T2</span></a>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#tfst"><span class="id" type="constructor">tfst</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="Norm.html#T1"><span class="id" type="variable">T1</span></a><br/>
&nbsp;&nbsp;| <a name="T_Snd"><span class="id" type="constructor">T_Snd</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">t</span> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> (<a class="idref" href="Norm.html#TProd"><span class="id" type="constructor">TProd</span></a> <a class="idref" href="Norm.html#T1"><span class="id" type="variable">T1</span></a> <a class="idref" href="Norm.html#T2"><span class="id" type="variable">T2</span></a>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#tsnd"><span class="id" type="constructor">tsnd</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="Norm.html#T2"><span class="id" type="variable">T2</span></a><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="T_True"><span class="id" type="constructor">T_True</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#ttrue"><span class="id" type="constructor">ttrue</span></a> <a class="idref" href="Norm.html#TBool"><span class="id" type="constructor">TBool</span></a> <br/>
&nbsp;&nbsp;| <a name="T_False"><span class="id" type="constructor">T_False</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#tfalse"><span class="id" type="constructor">tfalse</span></a> <a class="idref" href="Norm.html#TBool"><span class="id" type="constructor">TBool</span></a><br/>
&nbsp;&nbsp;| <a name="T_If"><span class="id" type="constructor">T_If</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">t0</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span> <span class="id" type="var">T</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t0"><span class="id" type="variable">t0</span></a> <a class="idref" href="Norm.html#TBool"><span class="id" type="constructor">TBool</span></a> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> <a class="idref" href="Norm.html#t0"><span class="id" type="variable">t0</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>) <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a><br/>
.<br/>

<br/>
<span class="id" type="keyword">Hint Constructors</span> <a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "has_type_cases" <span class="id" type="var">tactic</span>(<span class="id" type="tactic">first</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">first</span>;<br/>
&nbsp;&nbsp;[ <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "T_Var" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "T_Abs" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "T_App" <br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "T_Pair" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "T_Fst" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "T_Snd" <br/>
&nbsp;&nbsp;| <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "T_True" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "T_False" | <span class="id" type="var">Case_aux</span> <span class="id" type="var">c</span> "T_If" ].<br/>

<br/>
<span class="id" type="keyword">Hint Extern</span> 2 (<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <span class="id" type="var">_</span> (<a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) <span class="id" type="var">_</span>) ⇒ <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#T_App"><span class="id" type="constructor">T_App</span></a>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Hint Extern</span> 2 (<span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">_</span>) ⇒ <span class="id" type="tactic">compute</span>; <span class="id" type="tactic">reflexivity</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab925"></a><h3 class="section">Context Invariance</h3>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> : <a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> → <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> → <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="afi_var"><span class="id" type="constructor">afi_var</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tvar"><span class="id" type="constructor">tvar</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a>)<br/>
&nbsp;&nbsp;| <a name="afi_app1"><span class="id" type="constructor">afi_app1</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> → <a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>)<br/>
&nbsp;&nbsp;| <a name="afi_app2"><span class="id" type="constructor">afi_app2</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a> → <a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>)<br/>
&nbsp;&nbsp;| <a name="afi_abs"><span class="id" type="constructor">afi_abs</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">T11</span> <span class="id" type="var">t12</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t12"><span class="id" type="variable">t12</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a> <a class="idref" href="Norm.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Norm.html#T11"><span class="id" type="variable">T11</span></a> <a class="idref" href="Norm.html#t12"><span class="id" type="variable">t12</span></a>)<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="afi_pair1"><span class="id" type="constructor">afi_pair1</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>)<br/>
&nbsp;&nbsp;| <a name="afi_pair2"><span class="id" type="constructor">afi_pair2</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tpair"><span class="id" type="constructor">tpair</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>)<br/>
&nbsp;&nbsp;| <a name="afi_fst"><span class="id" type="constructor">afi_fst</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tfst"><span class="id" type="constructor">tfst</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>)<br/>
&nbsp;&nbsp;| <a name="afi_snd"><span class="id" type="constructor">afi_snd</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tsnd"><span class="id" type="constructor">tsnd</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>)<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <a name="afi_if0"><span class="id" type="constructor">afi_if0</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t0</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t0"><span class="id" type="variable">t0</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> <a class="idref" href="Norm.html#t0"><span class="id" type="variable">t0</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>)<br/>
&nbsp;&nbsp;| <a name="afi_if1"><span class="id" type="constructor">afi_if1</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t0</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> <a class="idref" href="Norm.html#t0"><span class="id" type="variable">t0</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>)<br/>
&nbsp;&nbsp;| <a name="afi_if2"><span class="id" type="constructor">afi_if2</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t0</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#tif"><span class="id" type="constructor">tif</span></a> <a class="idref" href="Norm.html#t0"><span class="id" type="variable">t0</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>)<br/>
.<br/>

<br/>
<span class="id" type="keyword">Hint Constructors</span> <a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="closed"><span class="id" type="definition">closed</span></a> (<span class="id" type="var">t</span>:<a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">¬</span></a> <a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="context_invariance"><span class="id" type="lemma">context_invariance</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">Gamma'</span> <span class="id" type="var">t</span> <span class="id" type="var">S</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#S"><span class="id" type="variable">S</span></a>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> → <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#Gamma'"><span class="id" type="variable">Gamma'</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a>)  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma'"><span class="id" type="variable">Gamma'</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#S"><span class="id" type="variable">S</span></a>.<br/>
<span class="id" type="keyword">Proof</span> <span class="id" type="keyword">with</span> <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">Gamma'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">has_type_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">H</span>) <span class="id" type="var">Case</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Gamma'</span> <span class="id" type="var">Heqv</span>...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_Var".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#T_Var"><span class="id" type="constructor">T_Var</span></a>... <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Heqv</span>...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_Abs".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#T_Abs"><span class="id" type="constructor">T_Abs</span></a>... <span class="id" type="tactic">apply</span> <span class="id" type="var">IHhas_type</span>. <span class="id" type="tactic">intros</span> <span class="id" type="var">y</span> <span class="id" type="var">Hafi</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span>)...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_Pair".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#T_Pair"><span class="id" type="constructor">T_Pair</span></a>...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_If".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#T_If"><span class="id" type="constructor">T_If</span></a>...<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="free_in_context"><span class="id" type="lemma">free_in_context</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t</span> <span class="id" type="var">T</span> <span class="id" type="var">Gamma</span>,<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> →<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> →<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">T'</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <a class="idref" href="Norm.html#T'"><span class="id" type="variable">T'</span></a>.<br/>
<span class="id" type="keyword">Proof</span> <span class="id" type="keyword">with</span> <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">t</span> <span class="id" type="var">T</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">Hafi</span> <span class="id" type="var">Htyp</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">has_type_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">Htyp</span>) <span class="id" type="var">Case</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">Hafi</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_Abs".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">IHHtyp</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">T'</span> <span class="id" type="var">Hctx</span>]... <span class="id" type="tactic">∃</span> <span class="id" type="var">T'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hctx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#neq_id"><span class="id" type="axiom">neq_id</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hctx</span>...<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Corollary</span> <a name="typable_empty__closed"><span class="id" type="lemma">typable_empty__closed</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t</span> <span class="id" type="var">T</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a>. <span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Norm.html#free_in_context"><span class="id" type="lemma">free_in_context</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">H1</span> <span class="id" type="var">H</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">T'</span> <span class="id" type="var">C</span>].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">C</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab926"></a><h3 class="section">Preservation</h3>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="substitution_preserves_typing"><span class="id" type="lemma">substitution_preserves_typing</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">x</span> <span class="id" type="var">U</span> <span class="id" type="var">v</span> <span class="id" type="var">t</span> <span class="id" type="var">S</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> (<a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#U"><span class="id" type="variable">U</span></a>) <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#S"><span class="id" type="variable">S</span></a>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> <a class="idref" href="Norm.html#U"><span class="id" type="variable">U</span></a>   →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="Norm.html#S"><span class="id" type="variable">S</span></a>.<br/>
<span class="id" type="keyword">Proof</span> <span class="id" type="keyword">with</span> <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">x</span> <span class="id" type="var">U</span> <span class="id" type="var">v</span> <span class="id" type="var">t</span> <span class="id" type="var">S</span> <span class="id" type="var">Htypt</span> <span class="id" type="var">Htypv</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">Gamma</span>. <span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">S</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">t_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>) <span class="id" type="var">Case</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">S</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">Htypt</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">Htypt</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "tvar".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rename</span> <span class="id" type="var">i</span> <span class="id" type="var">into</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "x=y".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#eq_id"><span class="id" type="lemma">eq_id</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">subst</span>. <span class="id" type="tactic">clear</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#context_invariance"><span class="id" type="lemma">context_invariance</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">Hcontra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Norm.html#free_in_context"><span class="id" type="lemma">free_in_context</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">S</span> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <span class="id" type="var">Hcontra</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">T'</span> <span class="id" type="var">HT'</span>]...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">HT'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "x&lt;&gt;y".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#T_Var"><span class="id" type="constructor">T_Var</span></a>... <span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#neq_id"><span class="id" type="axiom">neq_id</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "tabs".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rename</span> <span class="id" type="var">i</span> <span class="id" type="var">into</span> <span class="id" type="var">y</span>. <span class="id" type="tactic">rename</span> <span class="id" type="var">t</span> <span class="id" type="var">into</span> <span class="id" type="var">T11</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#T_Abs"><span class="id" type="constructor">T_Abs</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "x=y".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#context_invariance"><span class="id" type="lemma">context_invariance</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">Hafi</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">y</span> <span class="id" type="var">x</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "x&lt;&gt;y".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHt</span>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#context_invariance"><span class="id" type="lemma">context_invariance</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">z</span> <span class="id" type="var">Hafi</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">y</span> <span class="id" type="var">z</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#neq_id"><span class="id" type="axiom">neq_id</span></a>...<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="preservation"><span class="id" type="lemma">preservation</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">T</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a>.<br/>
<span class="id" type="keyword">Proof</span> <span class="id" type="keyword">with</span> <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">T</span> <span class="id" type="var">HT</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">remember</span> (@<a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a>) <span class="id" type="keyword">as</span> <span class="id" type="var">Gamma</span>. <span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">HeqGamma</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">t'</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">has_type_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">HT</span>) <span class="id" type="var">Case</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t'</span> <span class="id" type="var">HeqGamma</span> <span class="id" type="var">HE</span>; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">HE</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_App".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">HE</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">SCase</span> "ST_AppAbs".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#substitution_preserves_typing"><span class="id" type="lemma">substitution_preserves_typing</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">T1</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">HT1</span>...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_Fst".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">HT</span>...<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_Snd".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">HT</span>...<br/>
<span class="id" type="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab927"></a><h3 class="section">Determinism</h3>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="step_deterministic"><span class="id" type="lemma">step_deterministic</span></a> :<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="SfLib.html#deterministic"><span class="id" type="definition">deterministic</span></a> <a class="idref" href="Norm.html#step"><span class="id" type="inductive">step</span></a>.<br/>
<span class="id" type="keyword">Proof</span> <span class="id" type="keyword">with</span> <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#deterministic"><span class="id" type="definition">deterministic</span></a>.<br/>
 <span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab928"></a><h1 class="section">Normalization</h1>

<div class="paragraph"> </div>

 Now for the actual normalization proof. 

<div class="paragraph"> </div>

    Our goal is to prove that every well-typed term evaluates to a
    normal form.  In fact, it turns out to be convenient to prove
    something slightly stronger, namely that every well-typed term
    evaluates to a <i>value</i>.  This follows from the weaker property
    anyway via the Progress lemma (why?) but otherwise we don't need
    Progress, and we didn't bother re-proving it above.

<div class="paragraph"> </div>

    Here's the key definition: 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="halts"><span class="id" type="definition">halts</span></a>  (<span class="id" type="var">t</span>:<a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a>) : <span class="id" type="keyword">Prop</span> :=  <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">t'</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#::x_'==>*'_x"><span class="id" type="notation">==&gt;*</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a>  <a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>.<br/>

<br/>
</div>

<div class="doc">
A trivial fact: 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="value_halts"><span class="id" type="lemma">value_halts</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">v</span>, <a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> → <a class="idref" href="Norm.html#halts"><span class="id" type="definition">halts</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#halts"><span class="id" type="definition">halts</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">v</span>. <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#multi_refl"><span class="id" type="constructor">multi_refl</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The key issue in the normalization proof (as in many proofs by
induction) is finding a strong enough induction hypothesis.  To this
end, we begin by defining, for each type <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span>, a set <span class="inlinecode"><span class="id" type="var">R_T</span></span> of closed
terms of type <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span>.  We will specify these sets using a relation <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span>
and write <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span> <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> when <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> is in <span class="inlinecode"><span class="id" type="var">R_T</span></span>. (The sets <span class="inlinecode"><span class="id" type="var">R_T</span></span> are sometimes
called <i>saturated sets</i> or <i>reducibility candidates</i>.)

<div class="paragraph"> </div>

Here is the definition of <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> for the base language:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" type="inductive">bool</span></a></span> <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> iff <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> is a closed term of type <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" type="inductive">bool</span></a></span> and <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> halts in a value

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode">(<a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="StlcProp.html#T2"><span class="id" type="variable">T2</span></a>)</span> <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> iff <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> is a closed term of type <span class="inlinecode"><a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="StlcProp.html#T2"><span class="id" type="variable">T2</span></a></span> and <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> halts
  in a value <i>and</i> for any term <span class="inlinecode"><a class="idref" href="References.html#STLCRef.ExampleVariables.s"><span class="id" type="definition">s</span></a></span> such that <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a></span> <span class="inlinecode"><a class="idref" href="References.html#STLCRef.ExampleVariables.s"><span class="id" type="definition">s</span></a></span>, we have <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span>
  <span class="inlinecode"><a class="idref" href="StlcProp.html#T2"><span class="id" type="variable">T2</span></a></span> <span class="inlinecode">(<a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> <span class="inlinecode"><a class="idref" href="References.html#STLCRef.ExampleVariables.s"><span class="id" type="definition">s</span></a>)</span>. 
</li>
</ul>

<div class="paragraph"> </div>

 This definition gives us the strengthened induction hypothesis that we
need.  Our primary goal is to show that all <i>programs</i> ---i.e., all
closed terms of base type---halt.  But closed terms of base type can
contain subterms of functional type, so we need to know something
about these as well.  Moreover, it is not enough to know that these
subterms halt, because the application of a normalized function to a
normalized argument involves a substitution, which may enable more
evaluation steps.  So we need a stronger condition for terms of
functional type: not only should they halt themselves, but, when
applied to halting arguments, they should yield halting results.

<div class="paragraph"> </div>

The form of <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> is characteristic of the <i>logical relations</i> proof
technique.  (Since we are just dealing with unary relations here, we
could perhaps more properly say <i>logical predicates</i>.)  If we want to
prove some property <span class="inlinecode"><a class="idref" href="UseAuto.html#P"><span class="id" type="axiom">P</span></a></span> of all closed terms of type <span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.A"><span class="id" type="abbreviation">A</span></a></span>, we proceed by
proving, by induction on types, that all terms of type <span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.A"><span class="id" type="abbreviation">A</span></a></span> <i>possess</i>
property <span class="inlinecode"><a class="idref" href="UseAuto.html#P"><span class="id" type="axiom">P</span></a></span>, all terms of type <span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.A"><span class="id" type="abbreviation">A</span></a>→<a class="idref" href="RecordSub.html#Examples.A"><span class="id" type="abbreviation">A</span></a></span> <i>preserve</i> property <span class="inlinecode"><a class="idref" href="UseAuto.html#P"><span class="id" type="axiom">P</span></a></span>, all
terms of type <span class="inlinecode">(<a class="idref" href="RecordSub.html#Examples.A"><span class="id" type="abbreviation">A</span></a>→<a class="idref" href="RecordSub.html#Examples.A"><span class="id" type="abbreviation">A</span></a>)-&gt;(<a class="idref" href="RecordSub.html#Examples.A"><span class="id" type="abbreviation">A</span></a>→<a class="idref" href="RecordSub.html#Examples.A"><span class="id" type="abbreviation">A</span></a>)</span> <i>preserve the property of preserving</i>
property <span class="inlinecode"><a class="idref" href="UseAuto.html#P"><span class="id" type="axiom">P</span></a></span>, and so on.  We do this by defining a family of
predicates, indexed by types.  For the base type <span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.A"><span class="id" type="abbreviation">A</span></a></span>, the predicate is
just <span class="inlinecode"><a class="idref" href="UseAuto.html#P"><span class="id" type="axiom">P</span></a></span>.  For functional types, it says that the function should map
values satisfying the predicate at the input type to values satisfying
the predicate at the output type.

<div class="paragraph"> </div>

When we come to formalize the definition of <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> in Coq, we hit a
problem.  The most obvious formulation would be as a parameterized
Inductive proposition like this:

<div class="paragraph"> </div>

Inductive R : ty -&gt; tm -&gt; Prop :=
| R_bool : forall b t, has_type empty t TBool -&gt; 
                halts t -&gt; 
                R TBool t
| R_arrow : forall T1 T2 t, has_type empty t (TArrow T1 T2) -&gt; 
                halts t -&gt; 
                (forall s, R T1 s -&gt; R T2 (tapp t s)) -&gt; 
                R (TArrow T1 T2) t. 

<div class="paragraph"> </div>

Unfortunately, Coq rejects this definition because it violates the
<i>strict positivity requirement</i> for inductive definitions, which says
that the type being defined must not occur to the left of an arrow in
the type of a constructor argument. Here, it is the third argument to
<span class="inlinecode"><span class="id" type="var">R_arrow</span></span>, namely <span class="inlinecode">(<span class="id" type="keyword">∀</span></span> <span class="inlinecode"><a class="idref" href="References.html#STLCRef.ExampleVariables.s"><span class="id" type="definition">s</span></a>,</span> <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a></span> <span class="inlinecode"><a class="idref" href="References.html#STLCRef.ExampleVariables.s"><span class="id" type="definition">s</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><span class="id" type="var">TS</span></span> <span class="inlinecode">(<a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a></span> <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> <span class="inlinecode"><a class="idref" href="References.html#STLCRef.ExampleVariables.s"><span class="id" type="definition">s</span></a>))</span>, and
specifically the <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a></span> <span class="inlinecode"><a class="idref" href="References.html#STLCRef.ExampleVariables.s"><span class="id" type="definition">s</span></a></span> part, that violates this rule.  (The
outermost arrows separating the constructor arguments don't count when
applying this rule; otherwise we could never have genuinely inductive
predicates at all!)  The reason for the rule is that types defined
with non-positive recursion can be used to build non-terminating
functions, which as we know would be a disaster for Coq's logical
soundness. Even though the relation we want in this case might be
perfectly innocent, Coq still rejects it because it fails the
positivity test.

<div class="paragraph"> </div>

Fortunately, it turns out that we <i>can</i> define <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> using a
<span class="inlinecode"><span class="id" type="keyword">Fixpoint</span></span>: 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="R"><span class="id" type="definition">R</span></a> (<span class="id" type="var">T</span>:<a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a>) (<span class="id" type="var">t</span>:<a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">T</span>} : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="Norm.html#halts"><span class="id" type="definition">halts</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">match</span> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Norm.html#TBool"><span class="id" type="constructor">TBool</span></a>  ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Norm.html#TArrow"><span class="id" type="constructor">TArrow</span></a> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span> ⇒ (<span class="id" type="keyword">∀</span> <span class="id" type="var">s</span>, <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="var">T1</span> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a> → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="var">T2</span> (<a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#s"><span class="id" type="variable">s</span></a>))<br/>
<br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Norm.html#TProd"><span class="id" type="constructor">TProd</span></a> <span class="id" type="var">T1</span> <span class="id" type="var">T2</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#False"><span class="id" type="inductive">False</span></a> <br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
As immediate consequences of this definition, we have that every
element of every set <span class="inlinecode"><span class="id" type="var">R_T</span></span> halts in a value and is closed with type
<span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> :
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="R_halts"><span class="id" type="lemma">R_halts</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">T</span>} {<span class="id" type="var">t</span>}, <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> → <a class="idref" href="Norm.html#halts"><span class="id" type="definition">halts</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">T</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>;  <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="R_typable_empty"><span class="id" type="lemma">R_typable_empty</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">T</span>} {<span class="id" type="var">t</span>}, <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> → <a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">T</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H1</span>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Now we proceed to show the main result, which is that every
well-typed term of type <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span> is an element of <span class="inlinecode"><span class="id" type="var">R_T</span></span>.  Together with
<span class="inlinecode"><a class="idref" href="Norm.html#R_halts"><span class="id" type="lemma">R_halts</span></a></span>, that will show that every well-typed term halts in a
value.  
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab929"></a><h2 class="section">Membership in <span class="inlinecode"><span class="id" type="var">R_T</span></span> is invariant under evaluation</h2>

<div class="paragraph"> </div>

 We start with a preliminary lemma that shows a kind of strong
preservation property, namely that membership in <span class="inlinecode"><span class="id" type="var">R_T</span></span> is <i>invariant</i>
under evaluation. We will need this property in both directions,
i.e. both to show that a term in <span class="inlinecode"><span class="id" type="var">R_T</span></span> stays in <span class="inlinecode"><span class="id" type="var">R_T</span></span> when it takes a
forward step, and to show that any term that ends up in <span class="inlinecode"><span class="id" type="var">R_T</span></span> after a
step must have been in <span class="inlinecode"><span class="id" type="var">R_T</span></span> to begin with.

<div class="paragraph"> </div>

First of all, an easy preliminary lemma. Note that in the forward
direction the proof depends on the fact that our language is
determinstic. This lemma might still be true for non-deterministic
languages, but the proof would be harder! 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="step_preserves_halting"><span class="id" type="lemma">step_preserves_halting</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>, (<a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>) → (<a class="idref" href="Norm.html#halts"><span class="id" type="definition">halts</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<->'_x"><span class="id" type="notation">↔</span></a> <a class="idref" href="Norm.html#halts"><span class="id" type="definition">halts</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">ST</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#halts"><span class="id" type="definition">halts</span></a>.<br/>
&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;<span class="id" type="var">Case</span> "-&gt;".<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">t''</span> [<span class="id" type="var">STM</span> <span class="id" type="var">V</span>]].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">STM</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#ex_falso_quodlibet"><span class="id" type="lemma">ex_falso_quodlibet</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#value__normal"><span class="id" type="lemma">value__normal</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">V</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="Smallstep.html#normal_form"><span class="id" type="definition">normal_form</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">V</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">V</span>. <span class="id" type="tactic">∃</span> <span class="id" type="var">t'</span>. <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> (<a class="idref" href="Norm.html#step_deterministic"><span class="id" type="axiom">step_deterministic</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">ST</span> <span class="id" type="var">H</span>). <span class="id" type="tactic">∃</span> <span class="id" type="var">t''</span>. <span class="id" type="tactic">split</span>; <span class="id" type="tactic">assumption</span>.<br/>
&nbsp;<span class="id" type="var">Case</span> "&lt;-".<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [<span class="id" type="var">t'0</span> [<span class="id" type="var">STM</span> <span class="id" type="var">V</span>]].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">t'0</span>. <span class="id" type="tactic">split</span>; <span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Now the main lemma, which comes in two parts, one for each
   direction.  Each proceeds by induction on the structure of the type
   <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span>. In fact, this is where we make fundamental use of the
   structure of types. 

<div class="paragraph"> </div>

   One requirement for staying in <span class="inlinecode"><span class="id" type="var">R_T</span></span> is to stay in type <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span>. In the
   forward direction, we get this from ordinary type Preservation. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="step_preserves_R"><span class="id" type="lemma">step_preserves_R</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">T</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>, (<a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>) → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">T</span>;  <span class="id" type="tactic">intros</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">E</span> <span class="id" type="var">Rt</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a>; <span class="id" type="tactic">fold</span> <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a>; <span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Rt</span>; <span class="id" type="tactic">fold</span> <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Rt</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Rt</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">typable_empty_t</span> [<span class="id" type="var">halts_t</span> <span class="id" type="var">RRt</span>]].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#preservation"><span class="id" type="lemma">preservation</span></a>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>. <span class="id" type="tactic">apply</span> (<a class="idref" href="Norm.html#step_preserves_halting"><span class="id" type="lemma">step_preserves_halting</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">E</span>); <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#preservation"><span class="id" type="lemma">preservation</span></a>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>. <span class="id" type="tactic">apply</span> (<a class="idref" href="Norm.html#step_preserves_halting"><span class="id" type="lemma">step_preserves_halting</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">E</span>); <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <span class="id" type="var">IHT2</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span>  <a class="idref" href="Norm.html#ST_App1"><span class="id" type="constructor">ST_App1</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">RRt</span>; <span class="id" type="tactic">auto</span>.<br/>
 <span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
The generalization to multiple steps is trivial: 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="multistep_preserves_R"><span class="id" type="lemma">multistep_preserves_R</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">T</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>, <br/>
&nbsp;&nbsp;(<a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#::x_'==>*'_x"><span class="id" type="notation">==&gt;*</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>) → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">T</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">STM</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">STM</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHSTM</span>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#step_preserves_R"><span class="id" type="axiom">step_preserves_R</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
In the reverse direction, we must add the fact that <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> has type
   <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span> before stepping as an additional hypothesis. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="step_preserves_R'"><span class="id" type="lemma">step_preserves_R'</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">T</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> → (<a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#::x_'==>'_x"><span class="id" type="notation">==&gt;</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>) → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a> → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
 <span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="multistep_preserves_R'"><span class="id" type="lemma">multistep_preserves_R'</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">T</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> → (<a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#::x_'==>*'_x"><span class="id" type="notation">==&gt;*</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>) → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a> → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">T</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">HT</span> <span class="id" type="var">STM</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">STM</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#step_preserves_R'"><span class="id" type="axiom">step_preserves_R'</span></a>. <span class="id" type="tactic">assumption</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHSTM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#preservation"><span class="id" type="lemma">preservation</span></a>;  <span class="id" type="tactic">eauto</span>. <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab930"></a><h2 class="section">Closed instances of terms of type <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span> belong to <span class="inlinecode"><span class="id" type="var">R_T</span></span></h2>

<div class="paragraph"> </div>

 Now we proceed to show that every term of type <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span> belongs to
<span class="inlinecode"><span class="id" type="var">R_T</span></span>.  Here, the induction will be on typing derivations (it would be
surprising to see a proof about well-typed terms that did not
somewhere involve induction on typing derivations!).  The only
technical difficulty here is in dealing with the abstraction case.
Since we are arguing by induction, the demonstration that a term
<span class="inlinecode"><a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a></span> <span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.x"><span class="id" type="abbreviation">x</span></a></span> <span class="inlinecode"><a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a></span> <span class="inlinecode"><a class="idref" href="SfLib.html#t2"><span class="id" type="variable">t2</span></a></span> belongs to <span class="inlinecode"><span class="id" type="var">R_</span>(<a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a>→<a class="idref" href="StlcProp.html#T2"><span class="id" type="variable">T2</span></a>)</span> should involve applying the
induction hypothesis to show that <span class="inlinecode"><a class="idref" href="SfLib.html#t2"><span class="id" type="variable">t2</span></a></span> belongs to <span class="inlinecode"><span class="id" type="var">R_</span>(<a class="idref" href="StlcProp.html#T2"><span class="id" type="variable">T2</span></a>)</span>.  But
<span class="inlinecode"><span class="id" type="var">R_</span>(<a class="idref" href="StlcProp.html#T2"><span class="id" type="variable">T2</span></a>)</span> is defined to be a set of <i>closed</i> terms, while <span class="inlinecode"><a class="idref" href="SfLib.html#t2"><span class="id" type="variable">t2</span></a></span> may
contain <span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.x"><span class="id" type="abbreviation">x</span></a></span> free, so this does not make sense.

<div class="paragraph"> </div>

This problem is resolved by using a standard trick to suitably
generalize the induction hypothesis: instead of proving a statement
involving a closed term, we generalize it to cover all closed
<i>instances</i> of an open term <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span>.  Informally, the statement of the
lemma will look like this:

<div class="paragraph"> </div>

If <span class="inlinecode"><a class="idref" href="Poly.html#x1"><span class="id" type="variable">x1</span></a>:<a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a>,..<span class="id" type="var">xn</span>:<span class="id" type="var">Tn</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span> and <span class="inlinecode"><a class="idref" href="Smallstep.html#v1"><span class="id" type="variable">v1</span></a>,...,<span class="id" type="var">vn</span></span> are values such that 
<span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a></span> <span class="inlinecode"><a class="idref" href="Smallstep.html#v1"><span class="id" type="variable">v1</span></a></span>, <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><a class="idref" href="StlcProp.html#T2"><span class="id" type="variable">T2</span></a></span> <span class="inlinecode"><a class="idref" href="Stlc.html#v2"><span class="id" type="variable">v2</span></a></span>, ..., <span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><span class="id" type="var">Tn</span></span> <span class="inlinecode"><span class="id" type="var">vn</span></span>, then
<span class="inlinecode"><a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span> <span class="inlinecode">([<a class="idref" href="Poly.html#x1"><span class="id" type="variable">x1</span></a>:=<a class="idref" href="Smallstep.html#v1"><span class="id" type="variable">v1</span></a>][<a class="idref" href="Poly.html#x2"><span class="id" type="variable">x2</span></a>:=<a class="idref" href="Stlc.html#v2"><span class="id" type="variable">v2</span></a>]...[<span class="id" type="var">xn</span>:=<span class="id" type="var">vn</span>]<a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a>)</span>.

<div class="paragraph"> </div>

The proof will proceed by induction on the typing derivation
<span class="inlinecode"><a class="idref" href="Poly.html#x1"><span class="id" type="variable">x1</span></a>:<a class="idref" href="StlcProp.html#T1"><span class="id" type="variable">T1</span></a>,..<span class="id" type="var">xn</span>:<span class="id" type="var">Tn</span></span> <span class="inlinecode">|-</span> <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Basics.html#T"><span class="id" type="variable">T</span></a></span>; the most interesting case will be the one
for abstraction. 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab931"></a><h3 class="section">Multisubstitutions, multi-extensions, and instantiations</h3>

<div class="paragraph"> </div>

 However, before we can proceed to formalize the statement and
proof of the lemma, we'll need to build some (rather tedious)
machinery to deal with the fact that we are performing <i>multiple</i>
substitutions on term <span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span> and <i>multiple</i> extensions of the typing
context.  In particular, we must be precise about the order in which
the substitutions occur and how they act on each other.  Often these
details are simply elided in informal paper proofs, but of course Coq
won't let us do that. Since here we are substituting closed terms, we
don't need to worry about how one substitution might affect the term
put in place by another.  But we still do need to worry about the
<i>order</i> of substitutions, because it is quite possible for the same
identifier to appear multiple times among the <span class="inlinecode"><a class="idref" href="Poly.html#x1"><span class="id" type="variable">x1</span></a>,...<span class="id" type="var">xn</span></span> with
different associated <span class="inlinecode"><a class="idref" href="Records.html#vi"><span class="id" type="variable">vi</span></a></span> and <span class="inlinecode"><a class="idref" href="Records.html#Ti"><span class="id" type="variable">Ti</span></a></span>.

<div class="paragraph"> </div>

To make everything precise, we will assume that environments are
extended from left to right, and multiple substitutions are performed
from right to left.  To see that this is consistent, suppose we have
an environment written as <span class="inlinecode">...,<a class="idref" href="RecordSub.html#Examples.y"><span class="id" type="abbreviation">y</span></a>:<a class="idref" href="Basics.html#bool"><span class="id" type="inductive">bool</span></a>,...,<a class="idref" href="RecordSub.html#Examples.y"><span class="id" type="abbreviation">y</span></a>:<a class="idref" href="Poly.html#Church.nat"><span class="id" type="definition">nat</span></a>,...</span>  and a
corresponding term substitution written as <span class="inlinecode">...[<a class="idref" href="RecordSub.html#Examples.y"><span class="id" type="abbreviation">y</span></a>:=(<span class="id" type="var">tbool</span></span>
<span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" type="constructor">true</span></a>)]...[<a class="idref" href="RecordSub.html#Examples.y"><span class="id" type="abbreviation">y</span></a>:=(<a class="idref" href="References.html#STLCRef.tnat"><span class="id" type="constructor">tnat</span></a></span> <span class="inlinecode">3)]...<a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a></span>.  Since environments are extended from
left to right, the binding <span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.y"><span class="id" type="abbreviation">y</span></a>:<a class="idref" href="Poly.html#Church.nat"><span class="id" type="definition">nat</span></a></span> hides the binding <span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.y"><span class="id" type="abbreviation">y</span></a>:<a class="idref" href="Basics.html#bool"><span class="id" type="inductive">bool</span></a></span>; since
substitutions are performed right to left, we do the substitution
<span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.y"><span class="id" type="abbreviation">y</span></a>:=(<a class="idref" href="References.html#STLCRef.tnat"><span class="id" type="constructor">tnat</span></a></span> <span class="inlinecode">3)</span> first, so that the substitution <span class="inlinecode"><a class="idref" href="RecordSub.html#Examples.y"><span class="id" type="abbreviation">y</span></a>:=(<span class="id" type="var">tbool</span></span> <span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" type="constructor">true</span></a>)</span> has
no effect. Substitution thus correctly preserves the type of the term.

<div class="paragraph"> </div>

With these points in mind, the following definitions should make sense. 

<div class="paragraph"> </div>

A <i>multisubstitution</i> is the result of applying a list of
substitutions, which we call an <i>environment</i>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="env"><span class="id" type="definition">env</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a>).<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="msubst"><span class="id" type="definition">msubst</span></a> (<span class="id" type="var">ss</span>:<a class="idref" href="Norm.html#env"><span class="id" type="definition">env</span></a>) (<span class="id" type="var">t</span>:<a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">ss</span>} : <a class="idref" href="Norm.html#tm"><span class="id" type="inductive">tm</span></a> :=<br/>
<span class="id" type="keyword">match</span> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a> <span class="id" type="keyword">with</span><br/>
| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> ⇒ <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a><br/>
| (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><span class="id" type="var">ss'</span>) ⇒ <a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <span class="id" type="var">ss'</span> (<a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><span class="id" type="var">x</span><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><span class="id" type="var">s</span><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>)<br/>
<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
We need similar machinery to talk about repeated extension of a
    typing context using a list of (identifier, type) pairs, which we
    call a <i>type assignment</i>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="tass"><span class="id" type="definition">tass</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Norm.html#ty"><span class="id" type="inductive">ty</span></a>).<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="mextend"><span class="id" type="definition">mextend</span></a> (<span class="id" type="var">Gamma</span> : <span class="id" type="keyword">context</span>) (<span class="id" type="var">xts</span> : <a class="idref" href="Norm.html#tass"><span class="id" type="definition">tass</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Norm.html#xts"><span class="id" type="variable">xts</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> ⇒ <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a><br/>
&nbsp;&nbsp;| (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><span class="id" type="var">xts'</span>) ⇒ <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a> (<a class="idref" href="Norm.html#mextend"><span class="id" type="definition">mextend</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <span class="id" type="var">xts'</span>) <span class="id" type="var">x</span> <span class="id" type="var">v</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
We will need some simple operations that work uniformly on
environments and type assigments 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="lookup"><span class="id" type="definition">lookup</span></a> {<span class="id" type="var">X</span>:<span class="id" type="keyword">Set</span>} (<span class="id" type="var">k</span> : <a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a>) (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Norm.html#X"><span class="id" type="variable">X</span></a>)) {<span class="id" type="keyword">struct</span> <span class="id" type="var">l</span>} : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> <a class="idref" href="Norm.html#X"><span class="id" type="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Norm.html#l"><span class="id" type="variable">l</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">j</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">l'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">j</span> <a class="idref" href="Norm.html#k"><span class="id" type="variable">k</span></a> <span class="id" type="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">x</span> <span class="id" type="keyword">else</span> <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a> <a class="idref" href="Norm.html#k"><span class="id" type="variable">k</span></a> <span class="id" type="var">l'</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="drop"><span class="id" type="definition">drop</span></a> {<span class="id" type="var">X</span>:<span class="id" type="keyword">Set</span>} (<span class="id" type="var">n</span>:<a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a>) (<span class="id" type="var">nxs</span>:<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Norm.html#X"><span class="id" type="variable">X</span></a>)) {<span class="id" type="keyword">struct</span> <span class="id" type="var">nxs</span>} : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Norm.html#X"><span class="id" type="variable">X</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Norm.html#nxs"><span class="id" type="variable">nxs</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">n'</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><span class="id" type="var">nxs'</span>) ⇒ <span class="id" type="keyword">if</span> <a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">n'</span> <a class="idref" href="Norm.html#n"><span class="id" type="variable">n</span></a> <span class="id" type="keyword">then</span> <a class="idref" href="Norm.html#drop"><span class="id" type="definition">drop</span></a> <a class="idref" href="Norm.html#n"><span class="id" type="variable">n</span></a> <span class="id" type="var">nxs'</span> <span class="id" type="keyword">else</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">n'</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::(</span></a><a class="idref" href="Norm.html#drop"><span class="id" type="definition">drop</span></a> <a class="idref" href="Norm.html#n"><span class="id" type="variable">n</span></a> <span class="id" type="var">nxs'</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
An <i>instantiation</i> combines a type assignment and a value
   environment with the same domains, where corresponding elements are
   in R 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="instantiation"><span class="id" type="inductive">instantiation</span></a> :  <a class="idref" href="Norm.html#tass"><span class="id" type="definition">tass</span></a> → <a class="idref" href="Norm.html#env"><span class="id" type="definition">env</span></a> → <span class="id" type="keyword">Prop</span> :=<br/>
| <a name="V_nil"><span class="id" type="constructor">V_nil</span></a> : <a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> <br/>
| <a name="V_cons"><span class="id" type="constructor">V_cons</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">T</span> <span class="id" type="var">v</span> <span class="id" type="var">c</span> <span class="id" type="var">e</span>, <a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> → <a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a> → <a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a>).<br/>

<br/>
</div>

<div class="doc">
We now proceed to prove various properties of these definitions. 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab932"></a><h3 class="section">More Substitution Facts</h3>

<div class="paragraph"> </div>

 First we need some additional lemmas on (ordinary) substitution. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="vacuous_substitution"><span class="id" type="lemma">vacuous_substitution</span></a> : <span class="id" type="keyword">∀</span>  <span class="id" type="var">t</span> <span class="id" type="var">x</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">¬</span></a> <a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">t'</span>, <a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span> <span class="id" type="keyword">with</span> <span class="id" type="tactic">eauto</span>.<br/>
 <span class="id" type="var">Admitted</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="subst_closed"><span class="id" type="lemma">subst_closed</span></a>: <span class="id" type="keyword">∀</span> <span class="id" type="var">t</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>  →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t'</span>, <a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#vacuous_substitution"><span class="id" type="axiom">vacuous_substitution</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>. <span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="subst_not_afi"><span class="id" type="lemma">subst_not_afi</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t</span> <span class="id" type="var">x</span> <span class="id" type="var">v</span>, <a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> →  <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">¬</span></a> <a class="idref" href="Norm.html#appears_free_in"><span class="id" type="inductive">appears_free_in</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> (<a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>).<br/>
<span class="id" type="keyword">Proof</span> <span class="id" type="keyword">with</span> <span class="id" type="tactic">eauto</span>. &nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#not"><span class="id" type="definition">not</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="var">t_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>) <span class="id" type="var">Case</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">v</span> <span class="id" type="var">P</span> <span class="id" type="var">A</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tvar".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">i</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>; <span class="id" type="tactic">subst</span>. <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tapp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tabs".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">i</span>)...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tpair".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tfst".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tsnd".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>; <span class="id" type="tactic">subst</span>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "ttrue".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tfalse".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Case</span> "tif".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">A</span>; <span class="id" type="tactic">subst</span>...<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="duplicate_subst"><span class="id" type="lemma">duplicate_subst</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t'</span> <span class="id" type="var">x</span> <span class="id" type="var">t</span> <span class="id" type="var">v</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> → <a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]([</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#vacuous_substitution"><span class="id" type="axiom">vacuous_substitution</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#subst_not_afi"><span class="id" type="lemma">subst_not_afi</span></a>. <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="swap_subst"><span class="id" type="lemma">swap_subst</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t</span> <span class="id" type="var">x</span> <span class="id" type="var">x1</span> <span class="id" type="var">v</span> <span class="id" type="var">v1</span>, <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <a class="idref" href="Norm.html#x1"><span class="id" type="variable">x1</span></a> → <a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> → <a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a> <a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x1"><span class="id" type="variable">x1</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]([</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]([</span></a><a class="idref" href="Norm.html#x1"><span class="id" type="variable">x1</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v1"><span class="id" type="variable">v1</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">)</span></a>.<br/>
<span class="id" type="keyword">Proof</span> <span class="id" type="keyword">with</span> <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;<span class="id" type="var">t_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">t</span>) <span class="id" type="var">Case</span>; <span class="id" type="tactic">intros</span>; <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "tvar".<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">i</span>); <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x1</span> <span class="id" type="var">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="SfLib.html#ex_falso_quodlibet"><span class="id" type="lemma">ex_falso_quodlibet</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#eq_id"><span class="id" type="lemma">eq_id</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#subst_closed"><span class="id" type="lemma">subst_closed</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#eq_id"><span class="id" type="lemma">eq_id</span></a>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#subst_closed"><span class="id" type="lemma">subst_closed</span></a>...<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#neq_id"><span class="id" type="axiom">neq_id</span></a>... <span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#neq_id"><span class="id" type="axiom">neq_id</span></a>...<br/>
 <span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab933"></a><h3 class="section">Properties of multi-substitutions</h3>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="msubst_closed"><span class="id" type="lemma">msubst_closed</span></a>: <span class="id" type="keyword">∀</span> <span class="id" type="var">t</span>, <a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> → <span class="id" type="keyword">∀</span> <span class="id" type="var">ss</span>, <a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>. <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#subst_closed"><span class="id" type="lemma">subst_closed</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Closed environments are those that contain only closed terms. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="closed_env"><span class="id" type="definition">closed_env</span></a> (<span class="id" type="var">env</span>:<a class="idref" href="Norm.html#env"><span class="id" type="definition">env</span></a>) {<span class="id" type="keyword">struct</span> <span class="id" type="var">env</span>} :=<br/>
<span class="id" type="keyword">match</span> <a class="idref" href="Norm.html#env"><span class="id" type="variable">env</span></a> <span class="id" type="keyword">with</span><br/>
| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#True"><span class="id" type="inductive">True</span></a><br/>
| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><span class="id" type="var">env'</span> ⇒ <a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a> <span class="id" type="var">t</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="Norm.html#closed_env"><span class="id" type="definition">closed_env</span></a> <span class="id" type="var">env'</span><br/>
<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Next come a series of lemmas charcterizing how <span class="inlinecode"><a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a></span> of closed terms
    distributes over <span class="inlinecode"><span class="id" type="tactic">subst</span></span> and over each term form 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="subst_msubst"><span class="id" type="lemma">subst_msubst</span></a>: <span class="id" type="keyword">∀</span> <span class="id" type="var">env</span> <span class="id" type="var">x</span> <span class="id" type="var">v</span> <span class="id" type="var">t</span>, <a class="idref" href="Norm.html#closed"><span class="id" type="definition">closed</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> → <a class="idref" href="Norm.html#closed_env"><span class="id" type="definition">closed_env</span></a> <a class="idref" href="Norm.html#env"><span class="id" type="variable">env</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="Norm.html#env"><span class="id" type="variable">env</span></a> (<a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">]</span></a><a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">[</span></a><a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">:=</span></a><a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">](</span></a><a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> (<a class="idref" href="Norm.html#drop"><span class="id" type="definition">drop</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#env"><span class="id" type="variable">env</span></a>) <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="Norm.html#::'['_x_':='_x_']'_x"><span class="id" type="notation">)</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">env0</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>. <span class="id" type="tactic">fold</span> <a class="idref" href="Norm.html#closed_env"><span class="id" type="definition">closed_env</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">i</span> <span class="id" type="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#duplicate_subst"><span class="id" type="lemma">duplicate_subst</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#swap_subst"><span class="id" type="axiom">swap_subst</span></a>; <span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="msubst_var"><span class="id" type="lemma">msubst_var</span></a>:  <span class="id" type="keyword">∀</span> <span class="id" type="var">ss</span> <span class="id" type="var">x</span>, <a class="idref" href="Norm.html#closed_env"><span class="id" type="definition">closed_env</span></a> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a> → <br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a> (<a class="idref" href="Norm.html#tvar"><span class="id" type="constructor">tvar</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">t</span> ⇒ <span class="id" type="var">t</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> ⇒ <a class="idref" href="Norm.html#tvar"><span class="id" type="constructor">tvar</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">ss</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">i</span> <span class="id" type="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#msubst_closed"><span class="id" type="lemma">msubst_closed</span></a>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHss</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="msubst_abs"><span class="id" type="lemma">msubst_abs</span></a>: <span class="id" type="keyword">∀</span> <span class="id" type="var">ss</span> <span class="id" type="var">x</span> <span class="id" type="var">T</span> <span class="id" type="var">t</span>,  <br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a> (<a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> (<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> (<a class="idref" href="Norm.html#drop"><span class="id" type="definition">drop</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a>) <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">ss</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">i</span> <span class="id" type="var">x</span>); <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="msubst_app"><span class="id" type="lemma">msubst_app</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">ss</span> <span class="id" type="var">t1</span> <span class="id" type="var">t2</span>, <a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a> (<a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> (<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="Norm.html#t1"><span class="id" type="variable">t1</span></a>) (<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="Norm.html#ss"><span class="id" type="variable">ss</span></a> <a class="idref" href="Norm.html#t2"><span class="id" type="variable">t2</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">ss</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">IHss</span>. <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
You'll need similar functions for the other term constructors. 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a name="lab934"></a><h3 class="section">Properties of multi-extensions</h3>

<div class="paragraph"> </div>

 We need to connect the behavior of type assignments with that of their 
   corresponding contexts. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="mextend_lookup"><span class="id" type="lemma">mextend_lookup</span></a> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">c</span> : <a class="idref" href="Norm.html#tass"><span class="id" type="definition">tass</span></a>) (<span class="id" type="var">x</span>:<a class="idref" href="SfLib.html#id"><span class="id" type="inductive">id</span></a>), <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> (<a class="idref" href="Norm.html#mextend"><span class="id" type="definition">mextend</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a>) <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">c</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a>, <a class="idref" href="Norm.html#mextend"><span class="id" type="definition">mextend</span></a>, <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">i</span> <span class="id" type="var">x</span>); <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="mextend_drop"><span class="id" type="lemma">mextend_drop</span></a> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">c</span>: <a class="idref" href="Norm.html#tass"><span class="id" type="definition">tass</span></a>) <span class="id" type="var">Gamma</span> <span class="id" type="var">x</span> <span class="id" type="var">x'</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#mextend"><span class="id" type="definition">mextend</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#drop"><span class="id" type="definition">drop</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a>) <a class="idref" href="Norm.html#x'"><span class="id" type="variable">x'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="keyword">if</span> <a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#x'"><span class="id" type="variable">x'</span></a> <span class="id" type="keyword">then</span> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#x'"><span class="id" type="variable">x'</span></a> <span class="id" type="keyword">else</span> <a class="idref" href="Norm.html#mextend"><span class="id" type="definition">mextend</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Norm.html#x'"><span class="id" type="variable">x'</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">c</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">x'</span>); <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">i</span> <span class="id" type="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">x'</span>). <span class="id" type="tactic">auto</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#neq_id"><span class="id" type="axiom">neq_id</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">i</span> <span class="id" type="var">x'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">x'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="var">exfalso</span>. <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab935"></a><h3 class="section">Properties of Instantiations</h3>

<div class="paragraph"> </div>

 These are strightforward. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="instantiation_domains_match"><span class="id" type="lemma">instantiation_domains_match</span></a>: <span class="id" type="keyword">∀</span> {<span class="id" type="var">c</span>} {<span class="id" type="var">e</span>}, <br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a> → <span class="id" type="keyword">∀</span> {<span class="id" type="var">x</span>} {<span class="id" type="var">T</span>}, <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">∃</span></a> <span class="id" type="var">t</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'exists'_x_'..'_x_','_x"><span class="id" type="notation">,</span></a> <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">e</span> <span class="id" type="var">V</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">V</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">x0</span> <span class="id" type="var">T0</span> <span class="id" type="var">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">solve</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">inversion</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">x0</span>); <span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="instantiation_env_closed"><span class="id" type="lemma">instantiation_env_closed</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">c</span> <span class="id" type="var">e</span>,  <a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a> → <a class="idref" href="Norm.html#closed_env"><span class="id" type="definition">closed_env</span></a> <a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">e</span> <span class="id" type="var">V</span>; <span class="id" type="tactic">induction</span> <span class="id" type="var">V</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#closed_env"><span class="id" type="definition">closed_env</span></a>. <span class="id" type="tactic">fold</span> <a class="idref" href="Norm.html#closed_env"><span class="id" type="definition">closed_env</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#typable_empty__closed"><span class="id" type="lemma">typable_empty__closed</span></a>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#R_typable_empty"><span class="id" type="lemma">R_typable_empty</span></a>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="instantiation_R"><span class="id" type="lemma">instantiation_R</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">c</span> <span class="id" type="var">e</span>, <a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">t</span> <span class="id" type="var">T</span>, <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">e</span> <span class="id" type="var">V</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">V</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">x'</span> <span class="id" type="var">t'</span> <span class="id" type="var">T'</span> <span class="id" type="var">G</span> <span class="id" type="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">solve</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">inversion</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a> <span class="id" type="keyword">in</span> ×. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">x'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">G</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">E</span>; <span class="id" type="tactic">subst</span>. <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="instantiation_drop"><span class="id" type="lemma">instantiation_drop</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">c</span> <span class="id" type="var">env</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Norm.html#env"><span class="id" type="variable">env</span></a> → <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> (<a class="idref" href="Norm.html#drop"><span class="id" type="definition">drop</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a>) (<a class="idref" href="Norm.html#drop"><span class="id" type="definition">drop</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Norm.html#env"><span class="id" type="variable">env</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">e</span> <span class="id" type="var">V</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">V</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#drop"><span class="id" type="definition">drop</span></a>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">x0</span>); <span class="id" type="tactic">auto</span>. <span class="id" type="tactic">constructor</span>; <span class="id" type="tactic">eauto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab936"></a><h3 class="section">Congruence lemmas on multistep</h3>

<div class="paragraph"> </div>

 We'll need just a few of these; add them as the demand arises. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="multistep_App2"><span class="id" type="lemma">multistep_App2</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">v</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#value"><span class="id" type="inductive">value</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> → (<a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#::x_'==>*'_x"><span class="id" type="notation">==&gt;*</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a>) → <a class="idref" href="Norm.html#::x_'==>*'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a><a class="idref" href="Norm.html#::x_'==>*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Norm.html#::x_'==>*'_x"><span class="id" type="notation">==&gt;*</span></a> <a class="idref" href="Norm.html#::x_'==>*'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Norm.html#tapp"><span class="id" type="constructor">tapp</span></a> <a class="idref" href="Norm.html#v"><span class="id" type="variable">v</span></a> <a class="idref" href="Norm.html#t'"><span class="id" type="variable">t'</span></a><a class="idref" href="Norm.html#::x_'==>*'_x"><span class="id" type="notation">)</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">v</span> <span class="id" type="var">t</span> <span class="id" type="var">t'</span> <span class="id" type="var">V</span> <span class="id" type="var">STM</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">STM</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Smallstep.html#multi_refl"><span class="id" type="constructor">multi_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Smallstep.html#multi_step"><span class="id" type="constructor">multi_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#ST_App2"><span class="id" type="constructor">ST_App2</span></a>; <span class="id" type="tactic">eauto</span>. <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab937"></a><h3 class="section">The R Lemma.</h3>

<div class="paragraph"> </div>

 We finally put everything together.

<div class="paragraph"> </div>

    The key lemma about preservation of typing under substitution can
    be lifted to multi-substitutions: 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="msubst_preserves_typing"><span class="id" type="lemma">msubst_preserves_typing</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">c</span> <span class="id" type="var">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">Gamma</span> <span class="id" type="var">t</span> <span class="id" type="var">S</span>, <a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> (<a class="idref" href="Norm.html#mextend"><span class="id" type="definition">mextend</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a>) <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#S"><span class="id" type="variable">S</span></a> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="Norm.html#Gamma"><span class="id" type="variable">Gamma</span></a> (<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="Norm.html#e"><span class="id" type="variable">e</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>) <a class="idref" href="Norm.html#S"><span class="id" type="variable">S</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> 1; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H2</span>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHinstantiation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#substitution_preserves_typing"><span class="id" type="lemma">substitution_preserves_typing</span></a>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="Norm.html#R_typable_empty"><span class="id" type="lemma">R_typable_empty</span></a> <span class="id" type="var">H0</span>).<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
And at long last, the main lemma. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="msubst_R"><span class="id" type="lemma">msubst_R</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">c</span> <span class="id" type="var">env</span> <span class="id" type="var">t</span> <span class="id" type="var">T</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> (<a class="idref" href="Norm.html#mextend"><span class="id" type="definition">mextend</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a>) <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> → <a class="idref" href="Norm.html#instantiation"><span class="id" type="inductive">instantiation</span></a> <a class="idref" href="Norm.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="Norm.html#env"><span class="id" type="variable">env</span></a> → <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> (<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="Norm.html#env"><span class="id" type="variable">env</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">c</span> <span class="id" type="var">env0</span> <span class="id" type="var">t</span> <span class="id" type="var">T</span> <span class="id" type="var">HT</span> <span class="id" type="var">V</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">env0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">remember</span> (<a class="idref" href="Norm.html#mextend"><span class="id" type="definition">mextend</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <span class="id" type="var">c</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">Gamma</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <span class="id" type="var">Gamma</span> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a> <a class="idref" href="Norm.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="var">c</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HeqGamma</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#mextend_lookup"><span class="id" type="lemma">mextend_lookup</span></a>. <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">HeqGamma</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">has_type_cases</span> (<span class="id" type="tactic">induction</span> <span class="id" type="var">HT</span>) <span class="id" type="var">Case</span>; <span class="id" type="tactic">intros</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_Var".<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="Norm.html#instantiation_domains_match"><span class="id" type="lemma">instantiation_domains_match</span></a> <span class="id" type="var">V</span> <span class="id" type="var">H</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">t</span> <span class="id" type="var">P</span>].<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#instantiation_R"><span class="id" type="lemma">instantiation_R</span></a>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#msubst_var"><span class="id" type="lemma">msubst_var</span></a>. <span class="id" type="tactic">rewrite</span> <span class="id" type="var">P</span>. <span class="id" type="tactic">auto</span>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#instantiation_env_closed"><span class="id" type="lemma">instantiation_env_closed</span></a>; <span class="id" type="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_Abs".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#msubst_abs"><span class="id" type="lemma">msubst_abs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">WT</span>: <a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> (<a class="idref" href="Norm.html#tabs"><span class="id" type="constructor">tabs</span></a> <span class="id" type="var">x</span> <span class="id" type="var">T11</span> (<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> (<a class="idref" href="Norm.html#drop"><span class="id" type="definition">drop</span></a> <span class="id" type="var">x</span> <span class="id" type="var">env0</span>) <span class="id" type="var">t12</span>)) (<a class="idref" href="Norm.html#TArrow"><span class="id" type="constructor">TArrow</span></a> <span class="id" type="var">T11</span> <span class="id" type="var">T12</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#T_Abs"><span class="id" type="constructor">T_Abs</span></a>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#msubst_preserves_typing"><span class="id" type="lemma">msubst_preserves_typing</span></a>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#instantiation_drop"><span class="id" type="lemma">instantiation_drop</span></a>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#context_invariance"><span class="id" type="lemma">context_invariance</span></a>. <span class="id" type="tactic">apply</span> <span class="id" type="var">HT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#mextend_drop"><span class="id" type="lemma">mextend_drop</span></a>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">x0</span>). <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> - <span class="id" type="var">c</span> <span class="id" type="var">n</span>. <span class="id" type="tactic">induction</span> <span class="id" type="var">c</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="SfLib.html#neq_id"><span class="id" type="axiom">neq_id</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">i</span> <span class="id" type="var">x0</span>); <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a>. <span class="id" type="tactic">fold</span> <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a>. <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#value_halts"><span class="id" type="lemma">value_halts</span></a>. <span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#v_abs"><span class="id" type="constructor">v_abs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Norm.html#R_halts"><span class="id" type="lemma">R_halts</span></a> <span class="id" type="var">H0</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">v</span> [<span class="id" type="var">P</span> <span class="id" type="var">Q</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> (<a class="idref" href="Norm.html#multistep_preserves_R"><span class="id" type="lemma">multistep_preserves_R</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">P</span> <span class="id" type="var">H0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#multistep_preserves_R'"><span class="id" type="lemma">multistep_preserves_R'</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><span class="id" type="var">env0</span>) <span class="id" type="var">t12</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#T_App"><span class="id" type="constructor">T_App</span></a>. <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Norm.html#R_typable_empty"><span class="id" type="lemma">R_typable_empty</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Smallstep.html#multi_trans"><span class="id" type="lemma">multi_trans</span></a>. <span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#multistep_App2"><span class="id" type="lemma">multistep_App2</span></a>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Smallstep.html#multi_R"><span class="id" type="lemma">multi_R</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#subst_msubst"><span class="id" type="lemma">subst_msubst</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#ST_AppAbs"><span class="id" type="constructor">ST_AppAbs</span></a>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#typable_empty__closed"><span class="id" type="lemma">typable_empty__closed</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="Norm.html#R_typable_empty"><span class="id" type="lemma">R_typable_empty</span></a> <span class="id" type="var">H1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#instantiation_env_closed"><span class="id" type="lemma">instantiation_env_closed</span></a>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> (<span class="id" type="var">IHHT</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">T11</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a><span class="id" type="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="SfLib.html#extend"><span class="id" type="definition">extend</span></a>, <a class="idref" href="Norm.html#lookup"><span class="id" type="definition">lookup</span></a>. <span class="id" type="tactic">destruct</span> (<a class="idref" href="SfLib.html#eq_id_dec"><span class="id" type="lemma">eq_id_dec</span></a> <span class="id" type="var">x</span> <span class="id" type="var">x0</span>); <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">constructor</span>; <span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="var">Case</span> "T_App".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Norm.html#msubst_app"><span class="id" type="lemma">msubst_app</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<span class="id" type="var">IHHT1</span> <span class="id" type="var">c</span> <span class="id" type="var">H</span> <span class="id" type="var">env0</span> <span class="id" type="var">V</span>) <span class="id" type="keyword">as</span> [<span class="id" type="var">_</span> [<span class="id" type="var">_</span> <span class="id" type="var">P1</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> (<span class="id" type="var">IHHT2</span> <span class="id" type="var">c</span> <span class="id" type="var">H</span> <span class="id" type="var">env0</span> <span class="id" type="var">V</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">P2</span>. <span class="id" type="tactic">fold</span> <a class="idref" href="Norm.html#R"><span class="id" type="definition">R</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">P1</span>. <span class="id" type="tactic">auto</span>.<br/>

<br/>
 <span class="id" type="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab938"></a><h3 class="section">Normalization Theorem</h3>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="normalization"><span class="id" type="lemma">normalization</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">t</span> <span class="id" type="var">T</span>, <a class="idref" href="Norm.html#has_type"><span class="id" type="inductive">has_type</span></a> <a class="idref" href="SfLib.html#empty"><span class="id" type="definition">empty</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a> <a class="idref" href="Norm.html#T"><span class="id" type="variable">T</span></a> → <a class="idref" href="Norm.html#halts"><span class="id" type="definition">halts</span></a> <a class="idref" href="Norm.html#t"><span class="id" type="variable">t</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">replace</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span> (<a class="idref" href="Norm.html#msubst"><span class="id" type="definition">msubst</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> <span class="id" type="var">t</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (@<a class="idref" href="Norm.html#R_halts"><span class="id" type="lemma">R_halts</span></a> <span class="id" type="var">T</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="Norm.html#msubst_R"><span class="id" type="axiom">msubst_R</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a>); <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Norm.html#V_nil"><span class="id" type="constructor">V_nil</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
 
</div>
<div class="code">
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>